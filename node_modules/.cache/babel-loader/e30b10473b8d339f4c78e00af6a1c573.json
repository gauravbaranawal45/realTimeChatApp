{"ast":null,"code":"var _jsxFileName = \"/var/www/html/react_project/realchat/realtimechat/src/Pages/ChatroomPage.js\";\nimport React from \"react\";\nimport { withRouter } from \"react-router-dom\";\n\nconst ChatroomPage = ({\n  match,\n  socket\n}) => {\n  const chatroomId = match.params.id;\n  const [messages, setMessages] = React.useState([]);\n  const messageRef = React.useRef();\n  const [userId, setUserId] = React.useState(\"\");\n\n  const sendMessage = () => {\n    if (socket) {\n      socket.emit(\"chatroomMessage\", {\n        chatroomId,\n        message: messageRef.current.value\n      });\n      messageRef.current.value = \"\";\n    }\n\n    console.log('messages', messages);\n  };\n\n  React.useEffect(() => {\n    const token = localStorage.getItem(\"CC_Token\");\n    console.log('token', token);\n\n    if (token) {\n      const payload = JSON.parse(atob(token.split(\".\")[1]));\n      setUserId(payload.id);\n    }\n\n    console.log('token123', token);\n\n    if (socket) {\n      socket.on(\"newMessage\", message => {\n        console.log('message', message);\n        const newMessages = [...messages, message];\n        console.log('newMessages', newMessages);\n        setMessages(newMessages);\n      });\n    } //eslint-disable-next-line\n\n  }, [messages]);\n  React.useEffect(() => {\n    if (socket) {\n      socket.emit(\"joinRoom\", {\n        chatroomId\n      });\n    }\n\n    return () => {\n      //Component Unmount\n      if (socket) {\n        socket.emit(\"leaveRoom\", {\n          chatroomId\n        });\n      }\n    }; //eslint-disable-next-line\n  }, []);\n  console.log(userId);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"chatroomPage\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"chatroomSection\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"cardHeader\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 9\n    }\n  }, \"Chatroom Name\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"chatroomContent\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 9\n    }\n  }, messages.map((message, i) => /*#__PURE__*/React.createElement(\"div\", {\n    key: i,\n    className: \"message\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: userId === message.userId ? \"ownMessage\" : \"otherMessage\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 15\n    }\n  }, message.name, \":\"), \" \", message.message))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"chatroomActions\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    name: \"message\",\n    placeholder: \"Say something!\",\n    ref: messageRef,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    className: \"join\",\n    onClick: sendMessage,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 13\n    }\n  }, \"Send\")))));\n};\n\nexport default withRouter(ChatroomPage);","map":{"version":3,"sources":["/var/www/html/react_project/realchat/realtimechat/src/Pages/ChatroomPage.js"],"names":["React","withRouter","ChatroomPage","match","socket","chatroomId","params","id","messages","setMessages","useState","messageRef","useRef","userId","setUserId","sendMessage","emit","message","current","value","console","log","useEffect","token","localStorage","getItem","payload","JSON","parse","atob","split","on","newMessages","map","i","name"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport { withRouter } from \"react-router-dom\";\n\nconst ChatroomPage = ({ match, socket }) => {\n  const chatroomId = match.params.id;\n  const [messages, setMessages] = React.useState([]);\n  const messageRef = React.useRef();\n  const [userId, setUserId] = React.useState(\"\");\n\n\n  \n  const sendMessage = () => {\n    if (socket) {\n      socket.emit(\"chatroomMessage\", {\n        chatroomId,\n        message: messageRef.current.value,\n      });\n      messageRef.current.value = \"\";\n    }\n    console.log('messages',messages)\n  };\n\n  React.useEffect(() => {\n    const token = localStorage.getItem(\"CC_Token\");\n    console.log('token',token)\n    if (token) {\n      const payload = JSON.parse(atob(token.split(\".\")[1]));\n      setUserId(payload.id);\n    }\n    console.log('token123',token)\n    if (socket) {\n      socket.on(\"newMessage\", (message) => {\n        console.log('message',message)\n        const newMessages = [...messages, message];\n        console.log('newMessages',newMessages)\n        setMessages(newMessages);\n      });\n    }\n    //eslint-disable-next-line\n  }, [messages]);\n\n  React.useEffect(() => {\n    if (socket) {\n      socket.emit(\"joinRoom\", {\n        chatroomId,\n      });\n    }\n\n    return () => {\n      //Component Unmount\n      if (socket) {\n        socket.emit(\"leaveRoom\", {\n          chatroomId,\n        });\n      }\n    };\n    //eslint-disable-next-line\n  }, []);\n\n\n  console.log(userId)\n\n  return (\n    <div className=\"chatroomPage\">\n      <div className=\"chatroomSection\">\n        <div className=\"cardHeader\">Chatroom Name</div>\n        <div className=\"chatroomContent\">\n          {messages.map((message, i) => (\n            <div key={i} className=\"message\">\n              <span\n                className={\n                  userId === message.userId ? \"ownMessage\" : \"otherMessage\"\n                }\n              >\n                {message.name}:\n              </span>{\" \"}\n              {message.message}\n            </div>\n          ))}\n        </div>\n        <div className=\"chatroomActions\">\n          <div>\n            <input\n              type=\"text\"\n              name=\"message\"\n              placeholder=\"Say something!\"\n              ref={messageRef}\n            />\n          </div>\n          <div>\n            <button className=\"join\" onClick={sendMessage}>\n              Send\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default withRouter(ChatroomPage);"]},"metadata":{},"sourceType":"module"}